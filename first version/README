This is the first version of the rate function
